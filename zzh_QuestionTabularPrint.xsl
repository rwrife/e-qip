<?xml version="1.0" encoding="utf-8" standalone="no"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xt="http://www.jclark.com/xt"><xsl:template name="QuestionTabularPrint"><xsl:param name="IdPrefix"/><xsl:param name="QuestionEntryTagName"/><xsl:param name="QuestionEntryLookUpValue"/><xsl:param name="QuestionEntryTitle"/><xsl:param name="QuestionDataElement"/><xsl:param name="QuestionId"/><xsl:param name="AllowComment" select="'N'"/><xsl:param name="ShowQuestionId" select="'N'"/><xsl:param name="ShowSeperatorNFlag" select="number(true())"/><xsl:param name="SubsectionFormatClassList"/><xsl:param name="WrapperDataRowContent"/><xsl:variable name="SubsectionDataTableCellClassList"><xsl:if test="$ShowSeperatorNFlag"><xsl:value-of select="' SeparatorBorder'"/></xsl:if></xsl:variable><xsl:variable name="SubsectionIdTableCellClassList"><xsl:if test="$ShowSeperatorNFlag and $ShowQuestionId='Y'"><xsl:value-of select="' SeparatorBorder'"/></xsl:if></xsl:variable><tr><td><xsl:choose><xsl:when test="$ShowQuestionId='Y'"><xsl:attribute name="class"><xsl:value-of select="normalize-space(concat('SubSectionId TextRight ',$SubsectionIdTableCellClassList,' ',$SubsectionFormatClassList))"/></xsl:attribute></xsl:when><xsl:otherwise/></xsl:choose><xsl:if test="$ShowQuestionId='Y'"><xsl:value-of select="concat($QuestionId,'.')"/></xsl:if></td><td><xsl:attribute name="class"><xsl:value-of select="concat('MaxWidth VertTop ',normalize-space($SubsectionDataTableCellClassList))"/></xsl:attribute><xsl:variable name="QuestionEntryHeader"><xsl:choose><xsl:when test="normalize-space($QuestionEntryLookUpValue)"><xsl:copy-of select="$QuestionEntryLookUpValue"/></xsl:when><xsl:otherwise><div class="MaxWidth DataContent RptDetail"><span class="UnexpectedContent"><xsl:attribute name="id"><xsl:value-of select="concat($QuestionId,'_Question')"/></xsl:attribute><xsl:attribute name="title"><xsl:value-of select="$QuestionEntryTitle"/></xsl:attribute><xsl:value-of select="concat('? ',$QuestionEntryTagName,' ?')"/></span></div></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="QuestionData"><table cellpadding="0" cellspacing="0" class="RptDetail"><tbody><tr><td class="VertTop"><xsl:choose><xsl:when test="xt:node-set($QuestionEntryHeader)/Question"><div><xsl:attribute name="class"><xsl:choose><xsl:when test="$ShowQuestionId='Y'"><xsl:value-of select="'DataContent RptDetail'"/></xsl:when><xsl:otherwise><xsl:value-of select="'DataContentNoLeftPadding RptDetail'"/></xsl:otherwise></xsl:choose></xsl:attribute><span><xsl:attribute name="title"><xsl:value-of select="normalize-space($QuestionEntryTitle)"/></xsl:attribute><xsl:copy-of select="xt:node-set($QuestionEntryHeader)/Question/node()"/></span></div></xsl:when><xsl:otherwise><xsl:copy-of select="$QuestionEntryHeader"/></xsl:otherwise></xsl:choose></td><xsl:text/><td class="VertTop"><xsl:if test="normalize-space($QuestionDataElement/Answer)"><div class="DataContent RptDetail"><xsl:call-template name="OptionSelectionPrint"><xsl:with-param name="MouseOverTitle" select="'Answer to Question'"/><xsl:with-param name="ShownTitle" select="$QuestionDataElement/Answer"/></xsl:call-template></div></xsl:if></td></tr></tbody></table></xsl:variable><xsl:choose><xsl:when test="$AllowComment='Y'"><xsl:copy-of select="xt:node-set($QuestionData)"/><xsl:call-template name="DataIndentWrapperPrint"><xsl:with-param name="WrapperDataContent"><xsl:text/><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:if test="normalize-space($WrapperDataRowContent)"><xsl:copy-of select="$WrapperDataRowContent"/></xsl:if><xsl:call-template name="TabularCommentsPrint"><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'_',$QuestionId,'_')"/><xsl:with-param name="Comment" select="$QuestionDataElement/Comment"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Additional Comments'"/></xsl:call-template></tbody></table></xsl:with-param></xsl:call-template><xsl:text/></xsl:when><xsl:otherwise><xsl:copy-of select="xt:node-set($QuestionData)"/><xsl:if test="normalize-space($WrapperDataRowContent)"><xsl:call-template name="DataIndentWrapperPrint"><xsl:with-param name="WrapperDataContent"><xsl:text/><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:copy-of select="$WrapperDataRowContent"/></tbody></table></xsl:with-param></xsl:call-template><xsl:text/></xsl:if></xsl:otherwise></xsl:choose></td></tr></xsl:template></xsl:stylesheet>