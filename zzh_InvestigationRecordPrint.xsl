<?xml version="1.0" encoding="utf-8" standalone="no"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xt="http://www.jclark.com/xt"><xsl:strip-space elements="*"/><xsl:variable name="InvestigationRecordQuestions" select="document('InvestigationRecordQuestionTable.xml')"/><xsl:variable name="InvestigationsAgencys" select="document('InvestigationsAgencysTable.xml')"/><xsl:variable name="ClearanceLevels" select="document('ClearanceLevelsTable.xml')"/><xsl:template name="InvestigationRecordPrint"><xsl:param name="TitleType" select="'Field'"/><xsl:param name="TitlePrefixPhrase"/><xsl:param name="BaseTitlePhrase"/><xsl:param name="IdPrefix"/><xsl:param name="InvestigationRecord"/><xsl:param name="RootIdPrefix" select="'Section_'"/><xsl:param name="ShowSectionHeader" select="'Y'"/><xsl:param name="ShowSectionAttribValues" select="'N'"/><xsl:param name="ShowSubsectionIds" select="'N'"/><xsl:param name="TitleDelimiter" select="':'"/><xsl:variable name="HeaderDelimiter"><xsl:if test="normalize-space(concat($TitlePrefixPhrase,$BaseTitlePhrase))"><xsl:value-of select="$TitleDelimiter"/></xsl:if></xsl:variable><div class="MaxWidth DataContent RptDetail"><xsl:variable name="OutStdContainerValues"><xsl:call-template name="LeafContainerPrint"><xsl:with-param name="IdPrefix" select="$IdPrefix"/><xsl:with-param name="LeafContainerId" select="concat($RootIdPrefix,'Header')"/><xsl:with-param name="LeafContainerHeader" select="normalize-space(concat($TitlePrefixPhrase,' ',$BaseTitlePhrase,$HeaderDelimiter))"/><xsl:with-param name="ShowContainerHeader" select="$ShowSectionHeader"/><xsl:with-param name="TitleType" select="$TitleType"/><xsl:with-param name="LeafContainerTitle" select="normalize-space(concat($TitlePrefixPhrase,' ',$BaseTitlePhrase))"/><xsl:with-param name="ShowAttribValues" select="$ShowSectionAttribValues"/><xsl:with-param name="AttribTitle" select="normalize-space(concat($TitlePrefixPhrase,' ',$BaseTitlePhrase))"/><xsl:with-param name="LeafContainerElement" select="$InvestigationRecord"/></xsl:call-template></xsl:variable><xsl:if test="string-length(normalize-space($OutStdContainerValues))"><xsl:copy-of select="$OutStdContainerValues"/><xsl:value-of select="' '"/></xsl:if></div><xsl:text/><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:variable name="InvestigationRecordQuestionsLookUpPath" select="$InvestigationRecordQuestions/InvestigationRecordQuestions/Question"/><xsl:variable name="PriorInvestigationQuestionId" select="'a'"/><xsl:variable name="PriorInvestigationIdPrefix" select="concat($IdPrefix,$PriorInvestigationQuestionId,'_')"/><xsl:variable name="PriorInvestigationQuestionTitle" select="normalize-space(concat($TitlePrefixPhrase,' ',$BaseTitlePhrase,' Question'))"/><xsl:call-template name="QuestionTabularPrint"><xsl:with-param name="IdPrefix" select="concat($PriorInvestigationIdPrefix,'A_')"/><xsl:with-param name="QuestionEntryTagName" select="'PriorInvestigation'"/><xsl:with-param name="QuestionEntryLookUpValue" select="$InvestigationRecordQuestionsLookUpPath[@Code='PriorInvestigation']"/><xsl:with-param name="QuestionEntryTitle" select="$PriorInvestigationQuestionTitle"/><xsl:with-param name="QuestionDataElement" select="$InvestigationRecord/PriorInvestigation"/><xsl:with-param name="QuestionId" select="$PriorInvestigationQuestionId"/><xsl:with-param name="AllowComment" select="'N'"/><xsl:with-param name="ShowQuestionId" select="'Y'"/><xsl:with-param name="ShowSeperatorNFlag" select="number(false())"/><xsl:with-param name="WrapperDataRowContent"><xsl:call-template name="TabularCommentsPrint"><xsl:with-param name="IdPrefix" select="concat($PriorInvestigationIdPrefix,'A_',$PriorInvestigationQuestionId,'_')"/><xsl:with-param name="Comment" select="$InvestigationRecord/PriorInvestigation/Comment"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Additional Comments'"/></xsl:call-template><xsl:variable name="InvestigationsFragment"><xsl:choose><xsl:when test="count($InvestigationRecord/Investigations)        and count($InvestigationRecord/Investigations/Investigation)"><xsl:copy-of select="$InvestigationRecord/Investigations"/></xsl:when><xsl:when test="($InvestigationRecord/PriorInvestigation/Answer='Yes')"><Investigations><Investigation/></Investigations></xsl:when><xsl:otherwise/></xsl:choose></xsl:variable><xsl:if test="count(xt:node-set($InvestigationsFragment)/*)"><xsl:variable name="Investigations" select="xt:node-set($InvestigationsFragment)/Investigations"/><tr><td colspan="2"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="'B.'"/><xsl:with-param name="ShowSubsectionId" select="'N'"/><xsl:with-param name="ShowSeperatorNFlag" select="number(true())"/><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTitleAndStatusTabularWrapperPrint"><xsl:with-param name="IdPrefix" select="concat($PriorInvestigationIdPrefix,'B_')"/><xsl:with-param name="SubsectionHeader" select="'Investigations'"/><xsl:with-param name="ContainerElement" select="$Investigations"/><xsl:with-param name="WrapperDataContent"><xsl:if test="count($Investigations/Investigation)             or not(($Investigations/@DoNotKnow='True') or ($Investigations/@NotApplicable='True'))"><xsl:call-template name="DataIndentWrapperPrint"><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:for-each select="$Investigations/Investigation"><xsl:call-template name="InvestigationsEntryPrint"><xsl:with-param name="SubsectionId" select="position()"/><xsl:with-param name="IdPrefix" select="concat($PriorInvestigationIdPrefix,'B_',position(),'_')"/><xsl:with-param name="Investigation" select="."/><xsl:with-param name="ShowSeperator" select="number(position()!=1)"/><xsl:with-param name="TitlePrefixPhrase" select="$TitlePrefixPhrase"/><xsl:with-param name="BaseTitlePhrase" select="$BaseTitlePhrase"/><xsl:with-param name="ShowSubsectionId" select="$ShowSubsectionIds"/></xsl:call-template></xsl:for-each></tbody></table><xsl:text/></xsl:with-param></xsl:call-template><xsl:text/></xsl:if></xsl:with-param></xsl:call-template><xsl:text/></tbody></table><xsl:text/></xsl:with-param><xsl:text/></xsl:call-template><xsl:text/></tbody></table><xsl:text/></td></tr><xsl:text/></xsl:if></xsl:with-param></xsl:call-template><xsl:variable name="ClearanceDeniedQuestionId" select="'b'"/><xsl:variable name="ClearanceDeniedIdPrefix" select="concat($IdPrefix,$ClearanceDeniedQuestionId,'_')"/><xsl:variable name="ClearanceDeniedQuestionEntryTitle" select="normalize-space(concat($TitlePrefixPhrase,' ',$BaseTitlePhrase,' Question'))"/><xsl:call-template name="QuestionTabularPrint"><xsl:with-param name="IdPrefix" select="concat($ClearanceDeniedIdPrefix,'A_')"/><xsl:with-param name="QuestionEntryTagName" select="'ClearanceDenied'"/><xsl:with-param name="QuestionEntryLookUpValue" select="$InvestigationRecordQuestionsLookUpPath[@Code='ClearanceDenied']"/><xsl:with-param name="QuestionEntryTitle" select="$ClearanceDeniedQuestionEntryTitle"/><xsl:with-param name="QuestionDataElement" select="$InvestigationRecord/ClearanceDenied"/><xsl:with-param name="QuestionId" select="$ClearanceDeniedQuestionId"/><xsl:with-param name="AllowComment" select="'N'"/><xsl:with-param name="ShowQuestionId" select="'Y'"/><xsl:with-param name="ShowSeperatorNFlag" select="number(true())"/><xsl:with-param name="WrapperDataRowContent"><xsl:call-template name="TabularCommentsPrint"><xsl:with-param name="IdPrefix" select="concat($ClearanceDeniedIdPrefix,'A_',$ClearanceDeniedQuestionId,'_')"/><xsl:with-param name="Comment" select="$InvestigationRecord/ClearanceDenied/Comment"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Additional Comments'"/></xsl:call-template><xsl:variable name="ClearanceDenialsFragment"><xsl:choose><xsl:when test="count($InvestigationRecord/ClearanceDenials)        and count($InvestigationRecord/ClearanceDenials/ClearanceDenial)"><xsl:copy-of select="$InvestigationRecord/ClearanceDenials"/></xsl:when><xsl:when test="($InvestigationRecord/ClearanceDenied/Answer='Yes')"><ClearanceDenials><ClearanceDenial/></ClearanceDenials></xsl:when><xsl:otherwise/></xsl:choose></xsl:variable><xsl:if test="count(xt:node-set($ClearanceDenialsFragment)/*)"><xsl:variable name="ClearanceDenials" select="xt:node-set($ClearanceDenialsFragment)/ClearanceDenials"/><tr><td colspan="2"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="'B.'"/><xsl:with-param name="ShowSubsectionId" select="'N'"/><xsl:with-param name="ShowSeperatorNFlag" select="number(true())"/><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTitleAndStatusTabularWrapperPrint"><xsl:with-param name="IdPrefix" select="concat($ClearanceDeniedIdPrefix,'B_')"/><xsl:with-param name="SubsectionHeader" select="'Clearance Denials'"/><xsl:with-param name="ContainerElement" select="$ClearanceDenials"/><xsl:with-param name="WrapperDataContent"><xsl:if test="count($ClearanceDenials/ClearanceDenial)             or not(($ClearanceDenials/@DoNotKnow='True') or ($ClearanceDenials/@NotApplicable='True'))"><xsl:call-template name="DataIndentWrapperPrint"><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:for-each select="$ClearanceDenials/ClearanceDenial"><xsl:call-template name="ClearanceDenialsEntryPrint"><xsl:with-param name="SubsectionId" select="position()"/><xsl:with-param name="IdPrefix" select="concat($ClearanceDeniedIdPrefix,'B_',position(),'_')"/><xsl:with-param name="ClearanceDenial" select="."/><xsl:with-param name="ShowSeperator" select="number(position()!=1)"/><xsl:with-param name="TitlePrefixPhrase" select="$TitlePrefixPhrase"/><xsl:with-param name="BaseTitlePhrase" select="$BaseTitlePhrase"/><xsl:with-param name="ShowSubsectionId" select="$ShowSubsectionIds"/></xsl:call-template></xsl:for-each></tbody></table><xsl:text/></xsl:with-param></xsl:call-template><xsl:text/></xsl:if></xsl:with-param></xsl:call-template><xsl:text/></tbody></table><xsl:text/></xsl:with-param><xsl:text/></xsl:call-template><xsl:text/></tbody></table><xsl:text/></td></tr><xsl:text/></xsl:if></xsl:with-param></xsl:call-template></tbody></table><xsl:text/></xsl:template><xsl:template name="InvestigationsEntryPrint"><xsl:param name="SubsectionId"/><xsl:param name="IdPrefix"/><xsl:param name="Investigation"/><xsl:param name="ShowSeperator"/><xsl:param name="TitlePrefixPhrase"/><xsl:param name="BaseTitlePhrase"/><xsl:param name="ShowSubsectionId"/><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="concat(substring('   ',1,4 - (2 * string-length($SubsectionId))),'#',$SubsectionId)"/><xsl:with-param name="ShowSubsectionId" select="'Y'"/><xsl:with-param name="ShowSeperatorNFlag" select="$ShowSeperator"/><xsl:with-param name="SubsectionFormatClassList"/><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="'a.'"/><xsl:with-param name="ShowSubsectionId" select="$ShowSubsectionId"/><xsl:with-param name="ShowSeperatorNFlag" select="number(false())"/><xsl:with-param name="WrapperDataContent"><xsl:call-template name="InvestigationInfoPrint"><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'a','_')"/><xsl:with-param name="Investigation" select="$Investigation"/><xsl:with-param name="SubsectionTitle" select="concat($TitlePrefixPhrase,' ',$BaseTitlePhrase, ' Investigation')"/></xsl:call-template></xsl:with-param></xsl:call-template></tbody></table></xsl:with-param></xsl:call-template></xsl:template><xsl:template name="InvestigationInfoPrint"><xsl:param name="IdPrefix"/><xsl:param name="Investigation"/><xsl:param name="SubsectionTitle"/><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="TabularDatePrint"><xsl:with-param name="BaseTitlePhrase" select="'Date Investigation Initiated'"/><xsl:with-param name="IdPrefix" select="$IdPrefix"/><xsl:with-param name="Date" select="$Investigation/InvestigationDate/Date"/><xsl:with-param name="Precision" select="'month'"/></xsl:call-template><xsl:text/><xsl:call-template name="CodeLookUpTabularPrint"><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'Agency_')"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Investigating Agency'"/><xsl:with-param name="LookUpTable" select="$InvestigationsAgencys"/><xsl:with-param name="CodeValue2LookUp" select="$Investigation/Agency"/></xsl:call-template><xsl:text/><xsl:if test="$Investigation/Agency='Other'"><xsl:call-template name="TitledLeafFieldTabularPrint"><xsl:with-param name="FieldNameHeader" select="'Other Agency'"/><xsl:with-param name="FieldNameTitle" select="'Other Agency'"/><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'Other_Agency_')"/><xsl:with-param name="FieldElement" select="$Investigation/OtherAgency"/></xsl:call-template><xsl:text/></xsl:if><xsl:call-template name="CodeLookUpTabularPrint"><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'Clearance_Level_')"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Clearance Level'"/><xsl:with-param name="LookUpTable" select="$ClearanceLevels"/><xsl:with-param name="CodeValue2LookUp" select="$Investigation/ClearanceLevel"/></xsl:call-template><xsl:text/><xsl:call-template name="TabularCommentsPrint"><xsl:with-param name="IdPrefix" select="$IdPrefix"/><xsl:with-param name="Comment" select="$Investigation/Comment"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Additional Comments'"/></xsl:call-template><xsl:text/></tbody></table></xsl:template><xsl:template name="ClearanceDenialsEntryPrint"><xsl:param name="SubsectionId"/><xsl:param name="IdPrefix"/><xsl:param name="ClearanceDenial"/><xsl:param name="ShowSeperator"/><xsl:param name="TitlePrefixPhrase"/><xsl:param name="BaseTitlePhrase"/><xsl:param name="ShowSubsectionId"/><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="concat(substring('   ',1,4 - (2 * string-length($SubsectionId))),'#',$SubsectionId)"/><xsl:with-param name="ShowSubsectionId" select="'Y'"/><xsl:with-param name="ShowSeperatorNFlag" select="$ShowSeperator"/><xsl:with-param name="SubsectionFormatClassList"/><xsl:with-param name="WrapperDataContent"><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="SubsectionTabularWrapperPrint"><xsl:with-param name="SubsectionId" select="'a.'"/><xsl:with-param name="ShowSubsectionId" select="$ShowSubsectionId"/><xsl:with-param name="ShowSeperatorNFlag" select="number(false())"/><xsl:with-param name="WrapperDataContent"><xsl:call-template name="ClearanceDenialInfoPrint"><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'a','_')"/><xsl:with-param name="ClearanceDenial" select="$ClearanceDenial"/><xsl:with-param name="SubsectionTitle" select="concat($TitlePrefixPhrase,' ',$BaseTitlePhrase, ' Clearance Denial')"/></xsl:call-template></xsl:with-param></xsl:call-template></tbody></table></xsl:with-param></xsl:call-template></xsl:template><xsl:template name="ClearanceDenialInfoPrint"><xsl:param name="IdPrefix"/><xsl:param name="ClearanceDenial"/><xsl:param name="SubsectionTitle"/><table cellpadding="0" cellspacing="0" class="MaxWidth RptDetail"><tbody><xsl:call-template name="TabularDatePrint"><xsl:with-param name="BaseTitlePhrase" select="'Date Clearance Denied'"/><xsl:with-param name="IdPrefix" select="$IdPrefix"/><xsl:with-param name="Date" select="$ClearanceDenial/ClearanceDate/Date"/><xsl:with-param name="Precision" select="'month'"/></xsl:call-template><xsl:text/><xsl:call-template name="TitledLeafFieldTabularPrint"><xsl:with-param name="FieldNameHeader" select="'Investigating Agency'"/><xsl:with-param name="FieldNameTitle" select="'Investigating Agency'"/><xsl:with-param name="IdPrefix" select="concat($IdPrefix,'Agency_')"/><xsl:with-param name="FieldElement" select="$ClearanceDenial/Agency"/></xsl:call-template><xsl:text/><xsl:call-template name="TabularCommentsPrint"><xsl:with-param name="IdPrefix" select="$IdPrefix"/><xsl:with-param name="Comment" select="$ClearanceDenial/Comment"/><xsl:with-param name="TitlePrefixPhrase" select="''"/><xsl:with-param name="BaseTitlePhrase" select="'Additional Comments'"/></xsl:call-template><xsl:text/></tbody></table></xsl:template></xsl:stylesheet>